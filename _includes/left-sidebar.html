{% comment %}
Sidebar: Group posts by FIRST category; list oldest → newest.
Works on GitHub Pages (Liquid 4 + Jekyll 3.9/4.x).
{% endcomment %}

<aside class="sidebar-left" id="sidebar-left">
  <div class="sidebar-left-content">
    <nav class="sidebar-nav">

      <!-- TOP NAV from _config.yml (optional) -->
      {% if site.navigation_header %}
      <ul class="main-nav">
        {% for item in site.navigation_header %}
          {% assign is_active = page.url == item.url %}
          <li class="nav-link{% if is_active %} active{% endif %}">
            <a href="{{ item.url | relative_url }}">
              <i class="ph-duotone ph-{{ item.icon | default: 'house' }}"></i>{{ item.title }}
            </a>
          </li>
        {% endfor %}
      </ul>
      {% endif %}

      {% comment %}
      Group posts by first category.
      Then remove blank/undefined groups.
      Finally, sort sections alphabetically.
      {% endcomment %}
      {% assign grouped = site.posts | group_by_exp: 'p', 'p.categories | first' %}
      {% assign clean_groups = "" | split: "" %}
      {% for g in grouped %}
        {% if g.name and g.name != "" %}
          {% assign clean_groups = clean_groups | push: g %}
        {% endif %}
      {% endfor %}
      {% assign clean_groups = clean_groups | sort: 'name' %}

      <ul>
        {% for group in clean_groups %}
          <li class="nav-category">{{ group.name }}</li>

          {% comment %}
          Oldest → newest inside each section
          {% endcomment %}
          {% assign items_sorted = group.items | sort: 'date' %}
          {% for post in items_sorted %}
            {% assign is_active = page.url == post.url %}
            <li class="nav-link{% if is_active %} active{% endif %}">
              <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
            </li>
          {% endfor %}
        {% endfor %}
      </ul>

    </nav>
  </div>

  <div class="attribution-card" style="margin-top: 1rem;">
    <p>Created by <strong>Salesforce Release</strong>.</p>
  </div>
</aside>
