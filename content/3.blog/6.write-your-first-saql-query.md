---
title: Write Your First SAQL Query
description: A practical, beginner-friendly guide to understanding and writing your very first SAQL query in Salesforce CRM Analytics.
image:
  src: /media/SAQL-Query.png
authors:
  - name: Swarnil Singhai
    to: https://twitter.com/imswarnil
    avatar:
      src: https://i.pravatar.cc/128?u=5
date: 2024-02-01
badge:
  label: SAQL, Query, Fundamental
---

In Salesforce CRM Analytics (formerly Einstein Analytics / Tableau CRM), **SAQL** (Salesforce Analytics Query Language) is the language your dashboards secretly use behind the scenes.

If you can read and tweak a small SAQL query, you unlock:

* custom aggregations,
* smarter dashboard steps,
* and more control than the point‚Äëand‚Äëclick UI.

In this post, you‚Äôll literally write your **first working SAQL query** and understand what each line does.

---

## 1. What SAQL Actually Does

SAQL works on **datasets**, not on Salesforce objects directly.

* You use **Dataflows / Recipes** to prepare a dataset (for example, `Opportunity_Dataset`).
* SAQL then:

  * loads that dataset,
  * filters rows,
  * groups by a field,
  * calculates measures like sums or counts,
  * and returns a result table that powers your chart.

Think of SAQL as a tiny data‚Äëpipeline language inside CRM Analytics.

---

## 2. The Basic SAQL Shape

Most simple queries follow this pattern:

```sql [basic-pipeline.saql]{1-5}
q = load "Your_Dataset_Api_Name";
q = filter q by <conditions>;
q = group q by '<DimensionField>';
q = foreach q generate '<DimensionField>' as '<DimensionField>',
  <aggregation>('MeasureField') as '<Alias>';
q = limit q 10;
```

You‚Äôll see `q` reused on every line ‚Äì that‚Äôs the **pipeline** in action. Each statement takes `q`, transforms it, and passes it on.

---

## 3. Open SAQL Mode in a Lens

Before writing from scratch, it helps to see what Salesforce generates for you.

1. Go to **Analytics Studio**.
2. Open your **dataset** (for example, `Opportunity_Dataset`).
3. Click **Explore** to open a **lens**.
4. Build a quick bar chart:

   * Group by `StageName`.
   * Measure `Sum of Amount`.
5. Now click the **SAQL** toggle (Query Mode).

You‚Äôll see a query similar to this:

```sql [auto-generated.saql]
q = load "Opportunity_Dataset";
q = group q by 'StageName';
q = foreach q generate 'StageName' as 'StageName', sum('Amount') as 'sum_Amount';
q = order q by 'sum_Amount' desc;
q = limit q 2000;
```

That‚Äôs your first contact with SAQL: the **UI translated into code**.

---

## 4. Write Your First SAQL Query From Scratch

Goal:

> Show **Total Opportunity Amount by Stage**, sorted from highest to lowest, limited to the **top 7 stages**.

Here‚Äôs the full query:

```sql [first-saql-query.saql]{1-6}
q = load "Opportunity_Dataset";
q = group q by 'StageName';
q = foreach q generate
  'StageName' as 'StageName',
  sum('Amount') as 'Total_Amount';
q = order q by 'Total_Amount' desc;
q = limit q 7;
```

Let‚Äôs break each line.

### Line 1 ‚Äì `load`

```sql [first-saql-query.saql]{1}
q = load "Opportunity_Dataset";
```

* Loads your **dataset**.
* Make sure you use the **API name**, *not* the label.

### Line 2 ‚Äì `group`

```sql [first-saql-query.saql]{2}
q = group q by 'StageName';
```

* Tells SAQL to aggregate rows **per StageName**.
* After this line, `q` is grouped; you no longer have one row per Opportunity, but one row per Stage.

### Lines 3‚Äì4 ‚Äì `foreach ... generate`

```sql [first-saql-query.saql]{3-4}
q = foreach q generate
  'StageName' as 'StageName',
  sum('Amount') as 'Total_Amount';
```

* `foreach q generate` defines what your **output table** looks like.
* You:

  * keep `'StageName'` as your dimension,
  * calculate `sum('Amount')` as a new column `Total_Amount`.

### Line 5 ‚Äì `order`

```sql [first-saql-query.saql]{5}
q = order q by 'Total_Amount' desc;
```

* Sorts the rows from **largest** to **smallest** `Total_Amount`.

### Line 6 ‚Äì `limit`

```sql [first-saql-query.saql]{6}
q = limit q 7;
```

* Keeps only the **top 7** rows.
* Helps performance and makes charts readable.

---

## 5. Add a Filter ‚Äì Only Open Pipeline

Now let‚Äôs improve the query by focusing on **open** Opportunities.

```sql [first-saql-open-pipeline.saql]{1-7}
q = load "Opportunity_Dataset";
q = filter q by 'IsClosed' == false;
q = group q by 'StageName';
q = foreach q generate
  'StageName' as 'StageName',
  sum('Amount') as 'Open_Amount';
q = order q by 'Open_Amount' desc;
q = limit q 7;
```

Changes vs previous version:

* `filter` comes **right after** `load` (good habit).
* We renamed the measure alias to `Open_Amount` to make the output meaning clear.

### Common `filter` Patterns

```sql [filter-examples.saql]
q = filter q by 'StageName' in ["Prospecting", "Proposal"];
q = filter q by 'CloseDate' >= toDate("2024-01-01");
q = filter q by 'Owner.Region__c' == "APAC";
q = filter q by 'Amount' > 50000;
```

You can combine conditions with `and` / `or`:

```sql [filter-combined.saql]
q = filter q by 'IsClosed' == false and 'Amount' > 50000;
```

---

## 6. Change the Measure: `sum`, `count`, `avg`, `min`, `max`

Aggregations live inside `foreach ... generate`.

```sql [aggregations.saql]
q = foreach q generate
  'StageName' as 'StageName',
  sum('Amount') as 'Total_Amount',
  count() as 'Opp_Count',
  avg('Amount') as 'Avg_Deal_Size',
  max('Amount') as 'Biggest_Deal';
```

Common functions:

* `sum('Field')` ‚Äì total of a numeric field.
* `count()` ‚Äì number of rows in the group.
* `avg('Field')` ‚Äì average value.
* `min('Field')` / `max('Field')` ‚Äì minimum / maximum.

For your **very first query**, just start with `sum` or `count()`.

---

## 7. Multi-Level Grouping (Stage + Owner)

Once you‚Äôre comfortable with a single `group`, you can add another.

```sql [multi-group.saql]{1-6}
q = load "Opportunity_Dataset";
q = filter q by 'IsClosed' == false;
q = group q by ('StageName', 'Owner.Name');
q = foreach q generate
  'StageName' as 'StageName',
  'Owner.Name' as 'Owner_Name',
  sum('Amount') as 'Open_Amount';
q = order q by 'Open_Amount' desc;
q = limit q 50;
```

This now returns **one row per (Stage, Owner)** pair.

---

## 8. SAQL + Dashboards (Where This Actually Lives)

Most of the time, your SAQL won‚Äôt stay only in lenses ‚Äì it will be used inside **dashboard steps**.

Typical workflow:

1. Build a lens ‚Üí open SAQL ‚Üí tweak the query.
2. Save the lens as a **step** or add it as a widget in a dashboard.
3. Later, you can add **bindings** to change filters or measures using selection from other widgets.

Even if you never hand‚Äëedit the JSON, understanding SAQL helps you debug when something ‚Äúmysteriously‚Äù breaks.

---

## 9. Common Mistakes (and Quick Fixes)

### ‚ùå 1. Wrong dataset name in `load`

```sql
q = load "Opportunity";  -- Wrong: this is the object name, not dataset API name
```

‚úÖ Use the dataset API name:

```sql
q = load "Opportunity_Dataset";
```

---

### ‚ùå 2. Typos or case mistakes in field names

```sql
q = group q by 'stagename';  -- Wrong
```

‚úÖ Use the exact field name from the dataset:

```sql
q = group q by 'StageName';
```

---

### ‚ùå 3. Forgetting to include grouped fields in `foreach`

```sql
q = group q by 'StageName';
q = foreach q generate sum('Amount') as 'Total_Amount';  -- StageName missing
```

‚úÖ Include the grouped dimension:

```sql
q = group q by 'StageName';
q = foreach q generate
  'StageName' as 'StageName',
  sum('Amount') as 'Total_Amount';
```

---

### ‚ùå 4. No `limit` (or limit too high)

Huge result sets can slow down dashboards.

```sql
q = limit q 200000;  -- probably unnecessary
```

‚úÖ For charts, a small limit (10‚Äì200) is usually enough:

```sql
q = limit q 50;
```

---

## 10. Quick SAQL Cheat Sheet

```sql [cheatsheet.saql]{1-7}
q = load "Dataset_Api_Name";          -- Start with your dataset
q = filter q by <condition>;           -- Optional: narrow rows early
q = group q by '<Dimension>';          -- Group by a field (or fields)
q = foreach q generate                 -- Define output table
  '<Dimension>' as '<Dimension>',
  sum('Measure') as 'Total_Measure';
q = order q by 'Total_Measure' desc;   -- Sort (optional)
q = limit q 10;                        -- Limit rows
```

If you understand this pattern, you already know enough SAQL to:

* build solid charts,
* clean up auto-generated queries,
* and debug most basic dashboard steps.

---

## 11. What to Learn After Your First SAQL Query

Once you‚Äôre comfortable with this first query, the next topics to explore are:

* **Date bucketing** (close date by month/quarter/year)
* **Windowing functions** (running totals, moving averages)
* **Bindings** (dynamic SAQL driven by dashboard selections)
* **Security predicates & row‚Äëlevel security**

But none of that works well if this first mental model is shaky.

So for now:

1. Open a lens in your org.
2. Switch to **SAQL mode**.
3. Replace the auto-generated query with the **"first SAQL"** example above.
4. Adjust dataset and field names to match your org.

Congrats ‚Äì that‚Äôs your **first real SAQL query**, written and understood line by line. üéØ
