<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  {% include head.html %}
  <body>
    <div class="page-wrapper">
      {% include header.html %}
      {% include left-sidebar.html %}
        <div class="main-content-area">
            {% include adsense.html type="leaderboard" size="small" %}
            {% include hero.html %}
         <main class="content-wrapper">
            {{content}}
         </main>
        {% include right-sidebar.html %}
        </div>
        {% include adsense.html type="multiplex" %}

        {% include footer.html %}
    </div>

    <div class="mobile-overlay" id="mobile-overlay"></div>
    <div id="search-modal">
        <div class="search-overlay"></div>
        <div class="search-container">
            <div class="search-header">
                <i class="ph-duotone ph-magnifying-glass"></i>
                <input type="text" id="search-input" placeholder="Search lessons, components...">
            </div>
            <div class="search-results"></div>
        </div>
    </div>
<script>
(function() {
    // ============================================
    // DYNAMIC DATA
    // Mock data for search results. In a real app, this would be generated or fetched.
    // ============================================
    const searchData = [
        { icon: 'ph-palette', title: 'Theming', desc: 'Customize colors, fonts, and spacing.', category: 'Core Concepts', url: '#' },
        { icon: 'ph-code', title: 'Components', desc: 'Explore reusable UI components like tabs and cards.', category: 'Features', url: '#' }
    ];

    document.addEventListener('DOMContentLoaded', function () {
        
        // ============================================
        // MODULE: COPY CODE BUTTON
        // Adds a "Copy" button to each code block and handles the copy-to-clipboard logic.
        // ============================================
        document.querySelectorAll('.code-block-wrapper').forEach(wrapper => {
            const btn = wrapper.querySelector('.copy-button');
            const code = wrapper.querySelector('pre code').innerText;
            btn.addEventListener('click', () => {
                navigator.clipboard.writeText(code).then(() => {
                    btn.innerHTML = '<i class="ph-duotone ph-check"></i> Copied!';
                    setTimeout(() => {
                        btn.innerHTML = '<i class="ph-duotone ph-copy"></i> Copy';
                    }, 2000);
                });
            });
        });

        // ============================================
        // MODULE: TABLE OF CONTENTS & SCROLLSPY
        // Dynamically builds the TOC and highlights the active link based on scroll position.
        // ============================================
        const tocSource = document.getElementById('toc-source');
        const desktopToc = document.querySelector('.desktop-toc-container');
        const headings = document.querySelectorAll('article h2');

        if (tocSource && desktopToc && headings.length > 0) {
            desktopToc.innerHTML = ''; // Clear existing static links
            tocSource.querySelectorAll('a').forEach(link => {
                const dt = link.cloneNode(true);
                dt.classList.add('toc-link');
                desktopToc.appendChild(dt);
            });

            const observer = new IntersectionObserver(entries => {
                entries.forEach(entry => {
                    const id = entry.target.getAttribute('id');
                    const link = document.querySelector(`.toc-link[href="#${id}"]`);
                    if (entry.isIntersecting) {
                        document.querySelectorAll('.toc-link').forEach(l => l.classList.remove('active'));
                        if(link) link.classList.add('active');
                    }
                });
            }, { rootMargin: `-100px 0px -50% 0px`, threshold: 0.1 });

            headings.forEach(h => observer.observe(h));
        }

        // ============================================
        // MODULE: MOBILE SIDENAV
        // Toggles the visibility of the left sidebar on mobile devices.
        // ============================================
        const menuToggle = document.getElementById('mobile-menu-toggle');
        const sidebar = document.getElementById('sidebar-left');
        const mobileOverlay = document.getElementById('mobile-overlay');
        
        const closeMenu = () => {
            sidebar.classList.remove('is-open');
            mobileOverlay.classList.remove('is-active');
            document.body.classList.remove('modal-open');
        };
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('is-open');
            mobileOverlay.classList.toggle('is-active');
            document.body.classList.toggle('modal-open');
        });
        mobileOverlay.addEventListener('click', closeMenu);

        // ============================================
        // MODULE: DARK MODE THEME TOGGLE
        // Switches between light and dark themes and saves the preference in localStorage.
        // ============================================
        const themeToggle = document.getElementById('theme-toggle');
        const htmlEl = document.documentElement;

        const setTheme = theme => {
            htmlEl.classList.toggle('dark', theme === 'dark');
            themeToggle.querySelector('i').className = theme === 'dark' ? 'ph-duotone ph-moon' : 'ph-duotone ph-sun';
            localStorage.setItem('theme', theme);
        };

        const preferredTheme = localStorage.getItem('theme') || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light');
        setTheme(preferredTheme);
        themeToggle.addEventListener('click', () => setTheme(htmlEl.classList.contains('dark') ? 'light' : 'dark'));

        // ============================================
        // MODULE: SEARCH MODAL
        // Handles opening, closing, and interaction with the search modal.
        // ============================================
        const searchModal = document.getElementById('search-modal');
        const searchTriggers = [document.getElementById('search-trigger'), document.getElementById('search-trigger-mobile')];
        const searchOverlay = searchModal.querySelector('.search-overlay');
        const searchInput = document.getElementById('search-input');
        const resultsContainer = searchModal.querySelector('.search-results');
        let activeResultIndex = -1;

        const openSearch = () => {
            searchModal.classList.add('is-open');
            document.body.classList.add('modal-open');
            setTimeout(() => searchInput.focus(), 50);
            renderResults('');
        };
        const closeSearch = () => {
            searchModal.classList.remove('is-open');
            document.body.classList.remove('modal-open');
            searchInput.value = '';
        };

        const renderResults = query => {
            const filtered = searchData.filter(item => 
                item.title.toLowerCase().includes(query.toLowerCase()) || 
                item.desc.toLowerCase().includes(query.toLowerCase())
            );
            resultsContainer.innerHTML = '';
            activeResultIndex = -1;

            if (filtered.length === 0) {
                resultsContainer.innerHTML = '<div style="padding: 2rem; text-align: center; color: var(--docs-muted-foreground);">No results found.</div>';
                return;
            }
            const ul = document.createElement('ul');
            filtered.forEach((item, index) => {
                const li = document.createElement('li');
                li.className = 'search-result-item';
                li.dataset.index = index;
                li.innerHTML = `<a href="${item.url}"><div style="flex-shrink: 0; width: 32px; text-align: center;"><i class="ph-duotone ${item.icon}"></i></div><div style="flex-grow: 1;"><div style="font-weight:600;">${item.title}</div><div style="font-size: 0.875rem; color: var(--docs-muted-foreground);">${item.desc}</div></div><div style="font-size: 0.75rem; text-transform: uppercase; color: var(--docs-muted-foreground); background-color: var(--docs-secondary); padding: 0.1rem 0.4rem; border-radius: 0.25rem;">${item.category}</div></a>`;
                ul.appendChild(li);
            });
            resultsContainer.appendChild(ul);
        };
        
        const updateActiveResult = newIndex => {
            const items = resultsContainer.querySelectorAll('.search-result-item');
            if (items.length === 0) return;
            if (activeResultIndex > -1) items[activeResultIndex].classList.remove('active');
            
            if (newIndex >= items.length) newIndex = 0;
            if (newIndex < 0) newIndex = items.length - 1;
            
            items[newIndex].classList.add('active');
            items[newIndex].scrollIntoView({ block: 'nearest' });
            activeResultIndex = newIndex;
        };

        searchTriggers.forEach(trigger => trigger.addEventListener('click', openSearch));
        searchOverlay.addEventListener('click', closeSearch);
        searchInput.addEventListener('input', () => renderResults(searchInput.value));
        
        document.addEventListener('keydown', e => {
            if ((e.metaKey || e.ctrlKey) && e.key === 'k') { e.preventDefault(); openSearch(); }
            if (searchModal.classList.contains('is-open')) {
                if (e.key === 'Escape') closeSearch();
                if (e.key === 'ArrowDown') { e.preventDefault(); updateActiveResult(activeResultIndex + 1); }
                if (e.key === 'ArrowUp') { e.preventDefault(); updateActiveResult(activeResultIndex - 1); }
                if (e.key === 'Enter') {
                    const activeLink = resultsContainer.querySelector('.search-result-item.active a');
                    if (activeLink) activeLink.click();
                }
            }
        });
    });
})();
</script>

</body>


</html>
