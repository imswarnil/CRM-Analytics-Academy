<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
  {% include head.html %}
  <body class="layout-{{ page.layout }}{% if page.title %}  {{ page.title | slugify }}{% endif %}">
    <div class="{% if page.layout == 'home' or page.url == '/' %}home-wrapper{% else %}page-wrapper{% endif %}">
      <header class="header">
        {% include header.html %}
      </header>
      {{ content }}
      <footer class="main-footer">{% include footer.html %}</footer>
    </div>
  
    <div class="mobile-overlay" id="mobile-overlay"></div>
    <div id="search-modal">
      <div class="search-overlay"></div>
      <div class="search-container">
        <div class="search-header">
          <i class="ph-duotone ph-magnifying-glass"></i>
          <input type="text" id="search-input" placeholder="Search documentation...">
        </div>
        <div class="search-results"></div>
      </div>
    </div>

    {% if site.service_worker != false %}{% include site-sw.html %}{% endif %}
    {% include site-before-end.html %}
  <script>
    document.addEventListener("DOMContentLoaded", () => {
    const adPlaceholders = document.querySelectorAll('.adsense-container');
    const publisherId = "{{ site.adsense.publisher_id }}";

    if (!adPlaceholders.length || !publisherId) return;

    const adObserver = new IntersectionObserver((entries, observer) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const container = entry.target;
                const ad = {
                    type: container.dataset.adType,
                    slot: container.dataset.adSlot,
                    layoutKey: container.dataset.adLayoutKey,
                };

                const ins = document.createElement('ins');
                ins.className = 'adsbygoogle';
                ins.setAttribute('data-ad-client', publisherId);
                ins.setAttribute('data-ad-slot', ad.slot);

                // Build the precise <ins> tag for each ad type
                switch (ad.type) {
                    case 'Display':
                        ins.style.display = 'block';
                        ins.setAttribute('data-ad-format', 'auto');
                        ins.setAttribute('data-full-width-responsive', 'true');
                        break;
                    case 'In-article':
                        ins.style.display = 'block';
                        ins.style.textAlign = 'center';
                        ins.setAttribute('data-ad-layout', 'in-article');
                        ins.setAttribute('data-ad-format', 'fluid');
                        break;
                    case 'In-feed':
                        ins.style.display = 'block';
                        ins.setAttribute('data-ad-format', 'fluid');
                        ins.setAttribute('data-ad-layout-key', ad.layoutKey);
                        break;
                    case 'Multiplex':
                        // Note: Responsive multiplex ads are now recommended.
                        // The old fixed-size inline style is less common.
                        ins.style.display = 'block';
                        ins.setAttribute('data-ad-format', 'autorelaxed');
                        break;
                }
                
                const placeholderContent = container.querySelector('.adsense-unit-placeholder');
                if (placeholderContent) {
                    placeholderContent.replaceWith(ins);
                }

                try { (window.adsbygoogle = window.adsbygoogle || []).push({}); } 
                catch (e) { console.error("AdSense Error:", e); }

                container.classList.add('adsense-loaded');
                observer.unobserve(container);
            }
        });
    }, { rootMargin: '200px 0px' });

    adPlaceholders.forEach(placeholder => adObserver.observe(placeholder));
});
  </script>
  </body>

</html>